# ui.md

## 🎯 管理画面 UI 定義

本ドキュメントは、クライアントがログイン後に使用する SNS 自動 DM サービスの管理画面 UI 構成を定義します。Figma 等の設計ツールは使用せず、文章ベースで画面・動作を明示します。

---

## 🔐 認証状態

- Firebase Authentication によりログイン済みのユーザーのみアクセス可能。
- SNS アカウント、登録データはすべて `uid` によってスコープ管理される（他のユーザーからは不可視）。

---

## 🧭 メイン画面構成（ログイン後）

本 UI は PC 画面を前提に設計（スマホ表示にも対応）し、左側に垂直メニューを配置する：

```
┌───────────────────────────────┐
│ ログイン中ユーザー名またはメールアドレス                │
├───────────────────────────────┤
│ ▸ SNSアカウント連携                                │
│ ▸ ハッシュタグ登録                                  │
│ ▸ 投稿登録                                          │
│ ▸ ハッシュタグ管理                                  │
│ ▸ 投稿管理                                          │
└───────────────────────────────┘
```

- 各メニューをクリックすると、右側に対応する画面が表示される
- レイアウトはレスポンシブ対応し、モバイル時はハンバーガーメニューに切り替え

画面右上に「ログイン中のユーザー名（またはメールアドレス）」が表示される。

---

## 1. SNS アカウント連携画面

### 📌 機能

- 利用中 SNS の OAuth 認証を行う
- 現時点で連携可能：X（旧 Twitter） / Instagram / Threads / TikTok

### 📋 表示要素

- SNS ごとに、接続済みアカウントの一覧を表示（アカウント名＋接続済みの印）
- 各 SNS に対して「新しいアカウントを接続する」ボタンを設置 → `/api/sns/connect` 実行で URL 生成 → リダイレクト（未接続時） → `/api/sns/connect` 実行で URL 生成 → リダイレクト

### 💡 注意

- 接続済み SNS のみが、他タブで選択可能になる

---

## 2. ハッシュタグ登録画面

### 📌 機能

- 特定 SNS アカウントに対して、キャンペーン用ハッシュタグを登録
- 1SNS アカウントあたり複数登録可能

### 📋 入力項目

```
[対象SNS]（接続済みのみ選択可）
[対象アカウント]（選択されたSNSに紐づくアカウント）
[ハッシュタグ]（例：#夏のプレゼント）
[登録]ボタン
```

登録済みのハッシュタグ一覧が下部に表示される：

```
[SNS名] | [アカウント名] | [ハッシュタグ] | 実行ボタン
```

### ▶️ 実行ボタン

- 登録済みハッシュタグの一覧表において、各行の右端に表示される
- 手動で `POST /api/execute/hashtag` を実行
- 実行結果は簡易モーダル or トースト通知で表示

---

## 2.1 ハッシュタグ管理画面

### 📌 機能

- 登録済みハッシュタグの一覧表示
- ハッシュタグの編集（ハッシュタグ名、DMメッセージ）
- ハッシュタグの削除

### 📋 表示要素

```
┌─────────────────────────────────────────────┐
│ [ハッシュタグ管理]                                         │
├─────────────────────────────────────────────┤
│ [最新データを取得]ボタン                                   │
├─────────────────────────────────────────────┤
│ [#ハッシュタグ名] [SNS名]                               │
│ DM内容: [メッセージプレビュー]                            │
│ 登録日: YYYY/MM/DD | 更新日: YYYY/MM/DD                │
│ [編集] [削除]                                           │
├─────────────────────────────────────────────┤
│ （編集モード時）                                         │
│ ハッシュタグ: [入力フィールド]                            │
│ DMメッセージ: [テキストエリア]                           │
│ [キャンセル] [保存]                                     │
└─────────────────────────────────────────────┘
```

### 💡 機能詳細

- **編集**: インライン編集でハッシュタグとDMメッセージを変更可能
- **削除**: 確認ダイアログ後、論理削除（`is_active: false`）
- **リアルタイム更新**: 編集・削除後、即座にUIを更新

---

## 3. 投稿登録画面

### 📌 機能

- 特定 SNS アカウントに対して「対象投稿（例：質問募集 post など）」を登録
- 1SNS アカウントあたり複数登録可能

### 📋 入力項目

```
[対象SNS]（接続済みのみ選択可）
[対象アカウント]（選択されたSNSに紐づくアカウント）
[投稿ID]（Xの投稿ID）
[登録]ボタン
```

登録済みの投稿一覧が下部に表示される：

```
[SNS名] | [アカウント名] | [投稿ID] | 実行ボタン
```

### ▶️ 実行ボタン

- 登録済み投稿の一覧表において、各行の右端に表示される
- 手動で `POST /api/execute/reply` を実行
- 実行結果は簡易モーダル or トースト通知で表示

---

## 3.1 投稿管理画面

### 📌 機能

- 登録済み投稿の一覧表示
- 投稿の編集（投稿URL、DMメッセージ）
- 投稿の削除

### 📋 表示要素

```
┌─────────────────────────────────────────────┐
│ [投稿管理]                                             │
├─────────────────────────────────────────────┤
│ [最新データを取得]ボタン                                   │
├─────────────────────────────────────────────┤
│ 投稿ID: [投稿ID] [SNS名]                              │
│ URL: [投稿URLリンク]                                  │
│ DM内容: [メッセージプレビュー]                            │
│ 登録日: YYYY/MM/DD | 更新日: YYYY/MM/DD                │
│ [編集] [削除]                                           │
├─────────────────────────────────────────────┤
│ （編集モード時）                                         │
│ 投稿URL: [入力フィールド]                               │
│ 投稿ID: [自動取得・表示のみ]                             │
│ DMメッセージ: [テキストエリア]                           │
│ [キャンセル] [保存]                                     │
└─────────────────────────────────────────────┘
```

### 💡 機能詳細

- **編集**: インライン編集で投稿URLとDMメッセージを変更可能
- **投稿ID自動取得**: URLから投稿IDを自動抽出（Twitter/X形式対応）
- **削除**: 確認ダイアログ後、論理削除（`is_active: false`）
- **リアルタイム更新**: 編集・削除後、即座にUIを更新

---

## 🚫 SNS が未対応の場合

- SNS 選択時に、X 以外を選択すると以下のアラートを表示：
  - 「現在この SNS は DM 送信機能に未対応です（アカウント連携のみ可能）」

---

## 🔄 実行ボタンの動作（補足）

- ボタン押下時、API を実行し、成功・失敗メッセージをトースト通知で表示
- 失敗時は `/api.md` で定義されたエラーメッセージに従う

---

## ✅ 使用技術スタック（再掲）

- Angular 19 + PrimeNG + TailwindCSS
- Firebase Authentication + Firebase Hosting
- Firebase Functions（API）
